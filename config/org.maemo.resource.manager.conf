<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">

<busconfig>

  <!-- Define the system bus service -->
  <service name="org.maemo.resource.manager">
    <user>root</user>
    <group>system</group>
  </service>

  <!-- Access rules for system bus -->
  <policy context="default">
    <!-- Allow all root processes full access -->
    <allow send_destination="org.maemo.resource.manager"
           eavesdrop="true"
           own="true"/>
  </policy>

    <!-- Allow specific system services to call methods -->
    <policy context="org.sailfishos">
      <allow send_destination="org.maemo.resource.manager"
         send_interface="org.maemo.resource.manager"
         send_member="registerClient"/>
      <allow send_destination="org.maemo.resource.manager"
         send_interface="org.maemo.resource.manager"
         send_member="unregisterClient"/>
    </policy>


  <!-- Allow specific system services to call methods -->
  <policy context="org.sailfishos">
    <allow send_destination="org.maemo.resource.manager"
           send_interface="org.maemo.resource.manager"
           send_member="registerClient"/>
    <allow send_destination="org.maemo.resource.manager"
           send_interface="org.maemo.resource.manager"
           send_member="unregisterClient"/>
  </policy>

  <policy context="org.nemomobile">
    <allow send_destination="org.maemo.resource.manager"
           send_interface="org.maemo.resource.manager"
           send_member="registerClient"/>
    <allow send_destination="org.maemo.resource.manager"
           send_interface="org.maemo.resource.manager"
           send_member="unregisterClient"/>
  </policy>

</busconfig>
